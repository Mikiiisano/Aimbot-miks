local aimbotEnabled = false
local menuVisible = false
local accuracy = 1
local aimSpeed = 0.1

-- Crear interfaz gráfica (GUI)
local ScreenGui = Instance.new("ScreenGui")
local ToggleButton = Instance.new("TextButton")
local MenuFrame = Instance.new("Frame")
local CloseButton = Instance.new("TextButton")
local AccuracySlider = Instance.new("TextButton")
local AimSpeedSlider = Instance.new("TextButton")
local AccuracyValue = Instance.new("TextLabel")
local AimSpeedValue = Instance.new("TextLabel")

-- Configuración de los elementos de la GUI
ScreenGui.Name = "AimbotGUI"
ScreenGui.Parent = game.CoreGui

ToggleButton.Name = "ToggleButton"
ToggleButton.Parent = ScreenGui
ToggleButton.Text = "Aimbot"
ToggleButton.Size = UDim2.new(0, 100, 0, 50)
ToggleButton.Position = UDim2.new(0, 10, 0, 10)
ToggleButton.BackgroundColor3 = Color3.fromRGB(50, 50, 50)
ToggleButton.TextColor3 = Color3.fromRGB(255, 255, 255)

MenuFrame.Name = "MenuFrame"
MenuFrame.Parent = ScreenGui
MenuFrame.Size = UDim2.new(0, 200, 0, 200)
MenuFrame.Position = UDim2.new(0.5, -100, 0.5, -100)
MenuFrame.BackgroundColor3 = Color3.fromRGB(30, 30, 30)
MenuFrame.Visible = false

CloseButton.Name = "CloseButton"
CloseButton.Parent = MenuFrame
CloseButton.Text = "Close"
CloseButton.Size = UDim2.new(0, 50, 0, 30)
CloseButton.Position = UDim2.new(0.8, 0, 0, 0)

AccuracySlider.Name = "AccuracySlider"
AccuracySlider.Parent = MenuFrame
AccuracySlider.Text = "Accuracy"
AccuracySlider.Size = UDim2.new(0, 150, 0, 30)
AccuracySlider.Position = UDim2.new(0, 10, 0, 40)
AccuracySlider.BackgroundColor3 = Color3.fromRGB(70, 70, 70)

AimSpeedSlider.Name = "AimSpeedSlider"
AimSpeedSlider.Parent = MenuFrame
AimSpeedSlider.Text = "Aim Speed"
AimSpeedSlider.Size = UDim2.new(0, 150, 0, 30)
AimSpeedSlider.Position = UDim2.new(0, 10, 0, 80)
AimSpeedSlider.BackgroundColor3 = Color3.fromRGB(70, 70, 70)

AccuracyValue.Parent = MenuFrame
AccuracyValue.Size = UDim2.new(0, 150, 0, 30)
AccuracyValue.Position = UDim2.new(0, 10, 0, 120)
AccuracyValue.Text = "Accuracy: " .. accuracy

AimSpeedValue.Parent = MenuFrame
AimSpeedValue.Size = UDim2.new(0, 150, 0, 30)
AimSpeedValue.Position = UDim2.new(0, 10, 0, 160)
AimSpeedValue.Text = "Aim Speed: " .. aimSpeed

-- Funciones de control del aimbot
local function getClosestPlayer()
    local closestPlayer = nil
    local closestDistance = math.huge
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
            local distance = (player.Character.HumanoidRootPart.Position - game.Players.LocalPlayer.Character.HumanoidRootPart.Position).magnitude
            if distance < closestDistance then
                closestDistance = distance
                closestPlayer = player
            end
        end
    end
    return closestPlayer
end

local function aimAtPlayer(player)
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local targetPosition = player.Character.HumanoidRootPart.Position
        local camera = game.Workspace.CurrentCamera
        local direction = (targetPosition - camera.CFrame.Position).unit
        camera.CFrame = CFrame.new(camera.CFrame.Position, camera.CFrame.Position + direction * accuracy)
    end
end

local function toggleAimbot()
    aimbotEnabled = not aimbotEnabled
    if aimbotEnabled then
        ToggleButton.Text = "Aimbot ON"
    else
        ToggleButton.Text = "Aimbot OFF"
    end
end

-- Función para crear el ESP
local function createESP(player)
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        local username = Instance.new("BillboardGui")
        local textLabel = Instance.new("TextLabel")

        username.Adornee = player.Character.HumanoidRootPart
        username.Size = UDim2.new(0, 100, 0, 50)
        username.StudsOffset = Vector3.new(0, 2, 0)  -- Ajustar altura del texto
        username.Parent = player.Character.HumanoidRootPart

        textLabel.Size = UDim2.new(0, 100, 0, 50)
        textLabel.Text = player.Name
        textLabel.TextColor3 = Color3.new(1, 1, 1) -- Color blanco
        textLabel.BackgroundTransparency = 1 -- Transparente
        textLabel.TextStrokeTransparency = 0 -- Sin trazo
        textLabel.TextSize = 14
        textLabel.Parent = username

        -- Ajustar la transparencia
        textLabel.BackgroundTransparency = 0.5
    end
end

-- Eliminar ESP al salir
local function removeESP(player)
    if player and player.Character and player.Character:FindFirstChild("HumanoidRootPart") then
        for _, child in ipairs(player.Character.HumanoidRootPart:GetChildren()) do
            if child:IsA("BillboardGui") then
                child:Destroy()
            end
        end
    end
end

-- Conexiones de eventos
ToggleButton.MouseButton1Click:Connect(function()
    toggleAimbot()
    MenuFrame.Visible = not MenuFrame.Visible
end)

CloseButton.MouseButton1Click:Connect(function()
    MenuFrame.Visible = false
end)

AccuracySlider.MouseButton1Click:Connect(function()
    accuracy = accuracy + 0.1
    if accuracy > 5 then accuracy = 1 end  -- Limitar el valor máximo
    AccuracyValue.Text = "Accuracy: " .. accuracy
end)

AimSpeedSlider.MouseButton1Click:Connect(function()
    aimSpeed = aimSpeed + 0.1
    if aimSpeed > 1 then aimSpeed = 0.1 end  -- Limitar el valor máximo
    AimSpeedValue.Text = "Aim Speed: " .. aimSpeed
end)

-- Loop para el aimbot y ESP
game:GetService("RunService").RenderStepped:Connect(function()
    if aimbotEnabled then
        local closestPlayer = getClosestPlayer()
        if closestPlayer then
            aimAtPlayer(closestPlayer)
        end
    end

    -- Añadir ESP a todos los jugadores
    for _, player in ipairs(game.Players:GetPlayers()) do
        if player ~= game.Players.LocalPlayer then
            createESP(player)
        end
    end
end)

-- Limpiar el ESP al eliminar el jugador
game.Players.PlayerRemoving:Connect(function(player)
    removeESP(player)
end)
